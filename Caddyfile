:80 {
	# Activer la compression automatique
	encode gzip zstd

	# Répertoire racine contenant les fichiers statiques
	root * /srv

	# Configuration SPA : try_files tente de servir le fichier,
	# sinon redirige vers index.html pour le routing côté client
	try_files {path} /index.html

	# Servir les fichiers statiques
	file_server

	# Headers de sécurité
	header {
		# Empêcher le clickjacking
		X-Frame-Options "SAMEORIGIN"
		# Empêcher le sniffing MIME
		X-Content-Type-Options "nosniff"
		# Activer le filtre XSS
		X-XSS-Protection "1; mode=block"
		# Politique de référent stricte
		Referrer-Policy "strict-origin-when-cross-origin"
	}

	# Cache pour les assets statiques (JS, CSS, images)
	@static {
		path *.js *.css *.png *.jpg *.jpeg *.gif *.svg *.ico *.woff *.woff2 *.ttf *.eot
	}
	header @static Cache-Control "public, max-age=31536000, immutable"

	# Pas de cache pour index.html pour forcer le rechargement
	@html {
		path *.html
	}
	header @html Cache-Control "no-cache, no-store, must-revalidate"

	# Logs
	log {
		output stdout
		format console
	}
}

